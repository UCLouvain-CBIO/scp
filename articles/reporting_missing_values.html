<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reporting missing values for Single Cell Proteomics • scp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reporting missing values for Single Cell Proteomics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/scp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced.html">Advanced usage of `scp`</a>
    </li>
    <li>
      <a href="../articles/QFeatures_nutshell.html">QFeatures in a nutshell</a>
    </li>
    <li>
      <a href="../articles/read_scp.html">Load Single-Cell Proteomics data using `readSCP`</a>
    </li>
    <li>
      <a href="../articles/reporting_missing_values.html">Reporting missing values for Single Cell Proteomics</a>
    </li>
    <li>
      <a href="../articles/scp_data_modelling.html">Single Cell Proteomics data modelling</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/UCLouvain-CBIO/scp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reporting missing values for Single Cell
Proteomics</h1>
                        <h4 data-toc-skip class="author">Christophe
Vanderaa</h4>
                                    <h4 data-toc-skip class="author">Laurent
Gatto</h4>
                        
            <h4 data-toc-skip class="date">31 July 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/scp/blob/master/vignettes/reporting_missing_values.Rmd" class="external-link"><code>vignettes/reporting_missing_values.Rmd</code></a></small>
      <div class="hidden name"><code>reporting_missing_values.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to use <code>scp</code> to report
missing values, following our recommendations in <span class="citation">Vanderaa and Gatto (2023)</span>. Briefly, we recommend
reporting at least 4 metrics:</p>
<ul>
<li>Total sensitivity, i.e. the total number of features found in the
dataset</li>
<li>Local sensitivity, i.e. the number of features per cell</li>
<li>Data completeness, i.e. the proportion of values that are not
missing</li>
<li>Number of samples</li>
</ul>
<p>We will also demonstrate how to estimate total sensitivity when the
number of samples is too low and how to report data consistency using
the distribution of the Jaccard indices.</p>
<p>In this vignette, we will assume you are familiar with the
<code>scp</code> framework. If this is not the case, we suggest you
first read the <a href="https://uclouvain-cbio.github.io/scp/articles/scp.html" class="external-link">introduction
vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="minimal-data-processing">Minimal data processing<a class="anchor" aria-label="anchor" href="#minimal-data-processing"></a>
</h2>
<p>First, we load the <code>scp</code> package and retrieve a real-life
dataset from the <code>scpdata</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://UCLouvain-CBIO.github.io/scp" class="external-link">"scp"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"scpdata"</span><span class="op">)</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scpdata/man/leduc2022.html" class="external-link">leduc2022</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Next, we reduce the size of the dataset to the 30 first acquisitions.
This allows for a fast execution of the code for this vignette while
still being a representative demonstration on a real dataset. We also
keep only the feature annotations that will be used later in the
vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="va">leduc</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span></span>
<span><span class="co">#&gt; Warning: 'experiments' dropped; see 'drops()'</span></span>
<span><span class="co">#&gt; harmonizing input:</span></span>
<span><span class="co">#&gt;   removing 8057 sampleMap rows not in names(experiments)</span></span>
<span><span class="co">#&gt;   removing 1872 colData rownames not in sampleMap 'primary'</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">selectRowData</a></span><span class="op">(</span><span class="va">leduc</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Sequence"</span>, <span class="st">"Leading.razor.protein"</span>, <span class="st">"Reverse"</span>,</span>
<span>    <span class="st">"Potential.contaminant"</span>, <span class="st">"PEP"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This is the actual minimal processing: 1. filtering contaminant and
low-quality features 2. replacing zeros by missing values 3. keep only
samples that correspond to single cells 4. remove the feature absent in
all samples 5. aggregate PSMs to peptides 6. join all runs in a single
large assay</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 1.</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/filterFeatures.html" class="external-link">filterFeatures</a></span><span class="op">(</span><span class="va">leduc</span>, <span class="op">~</span> <span class="va">Reverse</span> <span class="op">!=</span> <span class="st">"+"</span> <span class="op">&amp;</span></span>
<span>                           <span class="va">Potential.contaminant</span> <span class="op">!=</span> <span class="st">"+"</span> <span class="op">&amp;</span></span>
<span>                           <span class="va">PEP</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="co">## 2.</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">zeroIsNA</a></span><span class="op">(</span><span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## 3.</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu">subsetByColData</span><span class="op">(</span></span>
<span>    <span class="va">leduc</span>, <span class="va">leduc</span><span class="op">$</span><span class="va">SampleType</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Monocyte"</span>, <span class="st">"Melanoma"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">## 4.</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">filterNA</a></span><span class="op">(</span><span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span>, pNA <span class="op">=</span> <span class="fl">0.9999</span><span class="op">)</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">dropEmptyAssays</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span></span>
<span><span class="co">## 5.</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">aggregateFeatures</a></span><span class="op">(</span></span>
<span>    <span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"peptides_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fcol <span class="op">=</span> <span class="st">"Sequence"</span>, fun <span class="op">=</span> <span class="va">colMedians</span></span>
<span><span class="op">)</span></span>
<span><span class="co">## 6.</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/joinAssays.html" class="external-link">joinAssays</a></span><span class="op">(</span></span>
<span>    <span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^peptides_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"peptides"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>What about proteins?</strong> if we were interested in
reporting missing values at the protein level, we simply need to change
<code>fcol = "Sequence"</code> to
<code>fcol = "Leading.razor.protein"</code> in
<code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">aggregateFeatures()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="report-missing-values">Report missing values<a class="anchor" aria-label="anchor" href="#report-missing-values"></a>
</h2>
<p>We can now compute the metrics of interest. We recommend computing
these for each cell type separately, since biological properties
specific to the cell type could influence the outcome. You can perform
this using <code><a href="../reference/reportMissingValues.html">reportMissingValues()</a></code>. We provide the dataset
and point towards the assay with the peptide quantification matrix
(<code>peptides</code>). The metrics are computed based on the cell
annotation <code>SampleType</code> that is available in the
<code>colData</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/reportMissingValues.html">reportMissingValues</a></span><span class="op">(</span><span class="va">leduc</span>, <span class="st">"peptides"</span>, by <span class="op">=</span> <span class="va">leduc</span><span class="op">$</span><span class="va">SampleType</span><span class="op">)</span></span>
<span><span class="co">#&gt;          LocalSensitivityMean LocalSensitivitySd TotalSensitivity Completeness</span></span>
<span><span class="co">#&gt; Monocyte             2664.213           367.7552             7028    0.3751356</span></span>
<span><span class="co">#&gt; Melanoma             2958.851           430.9701             7093    0.4166223</span></span>
<span><span class="co">#&gt;          NumberCells</span></span>
<span><span class="co">#&gt; Monocyte         197</span></span>
<span><span class="co">#&gt; Melanoma         195</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="advanced-criteria">Advanced criteria<a class="anchor" aria-label="anchor" href="#advanced-criteria"></a>
</h2>
<div class="section level3">
<h3 id="jaccard-index-distribution">Jaccard index distribution<a class="anchor" aria-label="anchor" href="#jaccard-index-distribution"></a>
</h3>
<p>The Jaccard index between a pair of cells is the number of features
shared by the two cells divided by the number of features identified in
any of the two columns. This provides a good measure of how consistent
the identifications are across single-cells. Again, biological
differences between cell types may decrease the consistency between
single cells and we therefore suggest to compute the Jaccard index for
each cell type separately. We compute the Jaccard index using
<code><a href="../reference/jaccardIndex.html">jaccardIndex()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ji</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jaccardIndex.html">jaccardIndex</a></span><span class="op">(</span><span class="va">leduc</span>, <span class="st">"peptides"</span>, by <span class="op">=</span> <span class="va">leduc</span><span class="op">$</span><span class="va">SampleType</span><span class="op">)</span></span></code></pre></div>
<p>The function returns a <code>data.frame</code> that we visualize
using the <code>ggplot2</code> package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ji</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">jaccard</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">by</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="reporting_missing_values_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The Jaccard indices peak around 50 %, meaning that about half of the
features are consistently found across single-cells within the same cell
type. Note also that some pairs of cells have consistency above 75 %.
These are pairs of cells from the same acquisition runs that were
multiplexed together with TMT labelling.</p>
</div>
<div class="section level3">
<h3 id="assessing-the-total-sensitivity">Assessing the total sensitivity<a class="anchor" aria-label="anchor" href="#assessing-the-total-sensitivity"></a>
</h3>
<p>To assess whether we can accurately estimate the total sensitivity,
we generate a cumulative sensitivity curve (CSC). More precisely, we
sample the identification matrix for an increasing number of cells (or
runs) and count the number of distinct features found across the sampled
cells. We repeat each sampling multiple times to account for the
stochasticity of the approach. The approach is implemented in
<code><a href="../reference/cumulativeSensitivityCurve.html">cumulativeSensitivityCurve()</a></code>. Again, we compute the curve
for each cell type separately. In the <code>leduc</code> dataset,
several cells are acquired in an MS run. When a features is identified
in a cell, it is most of the time also identified in all other cells of
that run, and this will distort the cumulative sensitivity curve.
Therefore, the function provides a <code>batch</code> argument to
account for this. Finally, <code>nSteps</code> defines the number of
random draws with increasing sample size, and <code>niters</code>
defines how many times each draw must be iterated.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cumulativeSensitivityCurve.html">cumulativeSensitivityCurve</a></span><span class="op">(</span><span class="va">leduc</span>, <span class="st">"peptides"</span>, by <span class="op">=</span> <span class="va">leduc</span><span class="op">$</span><span class="va">SampleType</span>,</span>
<span>                                  batch <span class="op">=</span> <span class="va">leduc</span><span class="op">$</span><span class="va">Set</span>, niters <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                                  nsteps <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p>The function returns a <code>data.frame</code> that we visualize
using the <code>ggplot2</code> package.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">plCSC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">csc</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SampleSize</span>, y <span class="op">=</span> <span class="va">Sensitivity</span>, colour <span class="op">=</span> <span class="va">by</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reporting_missing_values_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The cumulative sensitivity does not reach a plateau. This means that
we underestimated the total sensitivity in the previous section. We use
<code><a href="../reference/cumulativeSensitivityCurve.html">predictSensitivity()</a></code> to predict the total sensitivity from
these curves. The function fits an asymptotic regression model to assess
the relationship between the sensitivity and the sample size. Then, it
uses the model to predict the sensitivity for any sample size. (supplied
through <code>nSamples</code>). The function requires the
<code>data.frame</code> generated by
<code><a href="../reference/cumulativeSensitivityCurve.html">cumulativeSensitivityCurve()</a></code>. To assess the quality of the
fit, we first predict the sensitivity for the range of sample size.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predCSC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cumulativeSensitivityCurve.html">predictSensitivity</a></span><span class="op">(</span><span class="va">csc</span>, nSample <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">plCSC</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predCSC</span><span class="op">)</span></span></code></pre></div>
<p><img src="reporting_missing_values_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>We finally predict the total sensitivity, that is the sensitivity if
we had an infinite number of samples.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cumulativeSensitivityCurve.html">predictSensitivity</a></span><span class="op">(</span><span class="va">csc</span>, nSamples <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SampleSize Sensitivity       by</span></span>
<span><span class="co">#&gt; 1        Inf    7199.206 Monocyte</span></span>
<span><span class="co">#&gt; 2        Inf    7271.888 Melanoma</span></span></code></pre></div>
<p>The total sensitivity is predicted to be about 7200 peptides for both
cell types. So in the previous section, we underestimated the total
sensitivity by about 150 peptides.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This vignette is distributed under a <a href="https://creativecommons.org/licenses/by-sa/2.0/" class="external-link">CC BY-SA
license</a> license.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Vanderaa2023-gu" class="csl-entry">
Vanderaa, Christophe, and Laurent Gatto. 2023. <span>“Revisiting the
Thorny Issue of Missing Values in Single-Cell Proteomics,”</span> April.
<a href="https://arxiv.org/abs/2304.06654" class="external-link">https://arxiv.org/abs/2304.06654</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christophe Vanderaa, Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
