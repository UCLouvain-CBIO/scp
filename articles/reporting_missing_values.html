<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reporting missing values for Single Cell Proteomics • scp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reporting missing values for Single Cell Proteomics">
<meta property="og:description" content="scp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/scp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced.html">Advanced usage of `scp`</a>
    </li>
    <li>
      <a href="../articles/QFeatures_nutshell.html">QFeatures in a nutshell</a>
    </li>
    <li>
      <a href="../articles/read_scp.html">Load Single-Cell Proteomics data using `readSCP`</a>
    </li>
    <li>
      <a href="../articles/reporting_missing_values.html">Reporting missing values for Single Cell Proteomics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/UCLouvain-CBIO/scp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reporting missing values for Single Cell
Proteomics</h1>
                        <h4 data-toc-skip class="author">Christophe
Vanderaa</h4>
                                    <h4 data-toc-skip class="author">Laurent
Gatto</h4>
                        
            <h4 data-toc-skip class="date">30 May 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/scp/blob/HEAD/vignettes/reporting_missing_values.Rmd" class="external-link"><code>vignettes/reporting_missing_values.Rmd</code></a></small>
      <div class="hidden name"><code>reporting_missing_values.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to use <code>scp</code> to report
missing values, following our recommendations in <span class="citation">Vanderaa and Gatto (2023)</span>. Briefly, we recommend
reporting at least 4 metrics:</p>
<ul>
<li>Total sensitivity, i.e. the total number of features found in the
dataset</li>
<li>Local sensitivity, i.e. the number of features per cell</li>
<li>Data completeness, i.e. the proportion of values that are not
missing</li>
<li>Number of samples</li>
</ul>
<p>We will also demonstrate how to estimate total sensitivity when the
number of samples is too low and how to report data consistency using
the distribution of Jaccard indices.</p>
<p>In this vignette, we will assume you are familiar with the
<code>scp</code> framework. If this is not the case, we suggest you
first read the <a href="https://uclouvain-cbio.github.io/scp/articles/scp.html" class="external-link">introduction
vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="minimal-data-processing">Minimal data processing<a class="anchor" aria-label="anchor" href="#minimal-data-processing"></a>
</h2>
<p>First, we load the <code>scp</code> package and retrieve a real-life
dataset from the <code>scpdata</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://UCLouvain-CBIO.github.io/scp" class="external-link">"scp"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"scpdata"</span><span class="op">)</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scpdata/man/leduc2022.html" class="external-link">leduc2022</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Next, we reduce the size of the dataset to the 30 first acquisitions.
This allows for a fast execution of the code for this vignette while
still being a representative demonstration on a real dataset. We also
keep only the feature annotations that will be used later in the
vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="va">leduc</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span></span>
<span><span class="co">#&gt; Warning: 'experiments' dropped; see 'metadata'</span></span>
<span><span class="co">#&gt; harmonizing input:</span></span>
<span><span class="co">#&gt;   removing 8057 sampleMap rows not in names(experiments)</span></span>
<span><span class="co">#&gt;   removing 1872 colData rownames not in sampleMap 'primary'</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">selectRowData</a></span><span class="op">(</span><span class="va">leduc</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Sequence"</span>, <span class="st">"Leading.razor.protein"</span>, <span class="st">"Reverse"</span>, </span>
<span>    <span class="st">"Potential.contaminant"</span>, <span class="st">"PEP"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This is the actual minimal processing: 1. filtering contaminant and
low-quality features 2. replacing zeros by missing values 3. keep only
samples that correspond to single cells 4. remove the feature absent in
all samples.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-filtering.html" class="external-link">filterFeatures</a></span><span class="op">(</span><span class="va">leduc</span>, <span class="op">~</span> <span class="va">Reverse</span> <span class="op">!=</span> <span class="st">"+"</span> <span class="op">&amp;</span></span>
<span>                           <span class="va">Potential.contaminant</span> <span class="op">!=</span> <span class="st">"+"</span> <span class="op">&amp;</span></span>
<span>                           <span class="va">PEP</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">)</span> <span class="co">## 1.</span></span>
<span><span class="co">#&gt; 'Reverse' found in 30 out of 30 assay(s)</span></span>
<span><span class="co">#&gt; 'Potential.contaminant' found in 30 out of 30 assay(s)</span></span>
<span><span class="co">#&gt; 'PEP' found in 30 out of 30 assay(s)</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">zeroIsNA</a></span><span class="op">(</span><span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span><span class="op">)</span> <span class="co">## 2.</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">filterNA</a></span><span class="op">(</span><span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span>, pNA <span class="op">=</span> <span class="fl">0.9999</span><span class="op">)</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu">subsetByColData</span><span class="op">(</span> <span class="co">## 3.</span></span>
<span>    <span class="va">leduc</span>, <span class="va">leduc</span><span class="op">$</span><span class="va">SampleType</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Monocyte"</span>, <span class="st">"Melanoma cell"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">dropEmptyAssays</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span> <span class="co">## 4.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="peptide-identification-data">Peptide identification data<a class="anchor" aria-label="anchor" href="#peptide-identification-data"></a>
</h2>
<p>Next, we build the peptide identification matrix, that is a matrix
with single cells as columns and peptides as rows. We first need data at
peptide level, hence we aggregate the peptide to spectrum match data to
peptide data. We use a counting functions for aggregation, meaning that
we generate spectral count data for peptides.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">aggregateFeatures</a></span><span class="op">(</span></span>
<span>    <span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span>, </span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"spectral_counts_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fcol <span class="op">=</span> <span class="st">"Sequence"</span>, </span>
<span>    fun <span class="op">=</span> <span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MsCoreUtils/man/colCounts.html" class="external-link">colCounts</a></span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then, we join all runs in a single large assay.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/joinAssays.html" class="external-link">joinAssays</a></span><span class="op">(</span></span>
<span>    <span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^spec"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    name <span class="op">=</span> <span class="st">"spectral_counts"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Once all assay are joined, we extract that assay and replace any
observed count by 1 and any missing value by 0. This is the peptide
identification matrix.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu">getWithColData</span><span class="op">(</span><span class="va">leduc</span>, <span class="st">"spectral_counts"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: 'experiments' dropped; see 'metadata'</span></span>
<span><span class="fu">assay</span><span class="op">(</span><span class="va">ids</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="report-missing-values">Report missing values<a class="anchor" aria-label="anchor" href="#report-missing-values"></a>
</h2>
<p>We can now compute the metrics of interest. We recommend computing
these for each cell type separately, since biological properties
specific to the cell type could influence the outcome.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ids</span><span class="op">$</span><span class="va">SampleType</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">st</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">assay</span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">[</span>, <span class="va">ids</span><span class="op">$</span><span class="va">SampleType</span> <span class="op">==</span> <span class="va">st</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        LocalSensitivityMean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">x</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        LocalSensitivitySd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">x</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        TotalSensitivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>        Completeness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>        NumberCells <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          Monocyte Melanoma cell</span></span>
<span><span class="co">#&gt; LocalSensitivityMean 3403.6598985  3407.3589744</span></span>
<span><span class="co">#&gt; LocalSensitivitySd    202.2523708   203.5432130</span></span>
<span><span class="co">#&gt; TotalSensitivity     7111.0000000  7111.0000000</span></span>
<span><span class="co">#&gt; Completeness            0.4786472     0.4791673</span></span>
<span><span class="co">#&gt; NumberCells           197.0000000   195.0000000</span></span></code></pre></div>
<p><strong>What about proteins?</strong> To generate the same table for
proteins, we need to rebuild an identification matrix for peptides. In
this case, you simply need to change the aggregation call</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">aggregateFeatures</a></span><span class="op">(</span></span>
<span>    <span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span>, </span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"spectral_counts_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fcol <span class="op">=</span> <span class="st">"Sequence"</span>, </span>
<span>    fun <span class="op">=</span> <span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MsCoreUtils/man/colCounts.html" class="external-link">colCounts</a></span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>to</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leduc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">aggregateFeatures</a></span><span class="op">(</span></span>
<span>    <span class="va">leduc</span>, i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span>, </span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"spectral_counts_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">leduc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fcol <span class="op">=</span> <span class="st">"Leading.razor.protein"</span>, </span>
<span>    fun <span class="op">=</span> <span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MsCoreUtils/man/colCounts.html" class="external-link">colCounts</a></span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>All code that follows aggregation is exactly the same.</p>
</div>
<div class="section level2">
<h2 id="advanced-criteria">Advanced criteria<a class="anchor" aria-label="anchor" href="#advanced-criteria"></a>
</h2>
<p>On top of the four metrics computed in the previous section, we also
recommended exploring the jaccard indices and assessing whether enough
single cells are acquired to accurately estimate the total
sensitivity.</p>
<div class="section level3">
<h3 id="jaccard-index-distribution">Jaccard index distribution<a class="anchor" aria-label="anchor" href="#jaccard-index-distribution"></a>
</h3>
<p>We first need a custom function that computes the Jaccard index for
all pairs of columns given an identification matrix. The Jaccard index
in this context is the number of features shared by two columns divided
by the number of distinct features identified in any of the two columns.
This provides a good measure of how consistent the identifications are
across single-cells.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jaccardIndexFromIdMatrix</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">idMatrix</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">vectorSizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">idMatrix</span><span class="op">)</span></span>
<span>    <span class="va">pwVectorSizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">vectorSizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">vectorSizes</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="va">unionSize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">idMatrix</span><span class="op">)</span></span>
<span>    <span class="va">jacc</span> <span class="op">&lt;-</span> <span class="va">unionSize</span> <span class="op">/</span> <span class="op">(</span><span class="va">pwVectorSizes</span> <span class="op">-</span> <span class="va">unionSize</span><span class="op">)</span></span>
<span>    <span class="va">jacc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">jacc</span><span class="op">)</span><span class="op">]</span> <span class="co">## jacc is a symmetric matrix</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Next we plot the distribution of the jaccard indices. Again,
biological differences between cell types may decrease the consistency
between single cells. Therefore, we compute and plot the Jaccard index
for each cell type separately.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">st</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ids</span><span class="op">$</span><span class="va">SampleType</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">assay</span><span class="op">(</span><span class="va">ids</span><span class="op">)</span><span class="op">[</span>, <span class="va">ids</span><span class="op">$</span><span class="va">SampleType</span> <span class="op">==</span> <span class="va">st</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu">jaccardIndexFromIdMatrix</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, main <span class="op">=</span> <span class="va">st</span>, </span>
<span>         xlab <span class="op">=</span> <span class="st">"Jaccard index"</span>, breaks <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="reporting_missing_values_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>The Jaccard index is mainly distributed across 50 and 60 %, meaning
that about half of the features are consistently found across
single-cells within the same cell type. Note also that some pairs of
cells have perfect consistency. These are pairs of cells from the same
acquisition runs that were multiplexed together with TMT labelling.</p>
</div>
<div class="section level3">
<h3 id="assessing-the-total-sensitivity">Assessing the total sensitivity<a class="anchor" aria-label="anchor" href="#assessing-the-total-sensitivity"></a>
</h3>
<p>To assessing whether we can accurately estimate the total
sensitivity, we generate a cumulative sensitivity curve (CSC). The
functions below allows to generate that curve provided an identification
matrix. The algorithm samples columns from the matrix in gradually
increasing numbers (determined by <code>nsteps</code>). Each sampling is
repeated <code>niters</code> times to account for the stochasticity of
the approach.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">getSteps</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">assays</span>, <span class="va">nsteps</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">maxn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">assays</span><span class="op">)</span></span>
<span>    <span class="va">steps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">maxn</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">maxn</span>, <span class="va">nsteps</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">steps</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">groupSamples</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">by</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">by</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="va">by</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">cumulativeSensitivity</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">idMatrix</span>, <span class="va">niters</span>, <span class="va">nsteps</span>, </span>
<span>                                  <span class="va">groupSamplesBy</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">groupSamplesBy</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">idMatrix</span> <span class="op">&lt;-</span> <span class="fu">groupSamples</span><span class="op">(</span><span class="va">idMatrix</span>, by <span class="op">=</span> <span class="va">groupSamplesBy</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fu">getSteps</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">idMatrix</span><span class="op">)</span>, <span class="va">nsteps</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">niters</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">idMatrix</span><span class="op">)</span>, <span class="va">n</span><span class="op">)</span></span>
<span>            <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">idMatrix</span><span class="op">[</span>, <span class="va">sel</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>            <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>                <span class="va">out</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>                    i <span class="op">=</span> <span class="va">i</span>,</span>
<span>                    NumberSamples <span class="op">=</span> <span class="va">n</span>,</span>
<span>                    Sensitivity <span class="op">=</span> <span class="va">s</span></span>
<span>                <span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Again, we explore the csc for each cell type separately. Note that we
group the cells by acquisition run (<code>Set</code>).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ids</span><span class="op">$</span><span class="va">SampleType</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">st</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">ids</span><span class="op">[</span>, <span class="va">ids</span><span class="op">$</span><span class="va">SampleType</span> <span class="op">==</span> <span class="va">st</span><span class="op">]</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">cumulativeSensitivity</span><span class="op">(</span></span>
<span>        <span class="fu">assay</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, niters <span class="op">=</span> <span class="fl">10</span>, nsteps <span class="op">=</span> <span class="fl">30</span>, groupSamplesBy <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">Set</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">out</span><span class="op">$</span><span class="va">SampleType</span> <span class="op">&lt;-</span> <span class="va">st</span></span>
<span>    <span class="va">out</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">csc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">csc</span><span class="op">)</span></span></code></pre></div>
<p>Next, we plot the cumlulative sensitivity for each cell type
separately.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">plCumS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">csc</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NumberSamples</span>, y <span class="op">=</span> <span class="va">Sensitivity</span>, colour <span class="op">=</span> <span class="va">SampleType</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Sensitivity"</span>, x <span class="op">=</span> <span class="st">"Number of MS acquisitions"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>        legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reporting_missing_values_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>The cumulative sensitivity does not plateau, although it almost
reaches it. This means that we slightly underestimate the total
sensitivity. This is because we have subset the data at the beginning of
the script, and including more datasets allows to reach the plateau.</p>
<p>We will now predict the total sensitivity. Since both cell types
exhibit the same trends, we will perform the prediction for the two cell
types combined. We first fit an asymptotic regression model to assess
the relationship between the sensitivity and the number of MS runs.
Then, we predict the response and plot these preduction on the previous
graph.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AsymptoticRegressionModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">Sensitivity</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/SSasymp.html" class="external-link">SSasymp</a></span><span class="op">(</span><span class="va">NumberSamples</span>, <span class="va">Asym</span>, <span class="va">R0</span>, <span class="va">lrc</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">csc</span>,</span>
<span>    weights <span class="op">=</span> <span class="va">csc</span><span class="op">$</span><span class="va">NumberSamples</span><span class="op">^</span><span class="fl">2</span> <span class="co">## data is heterorscedastic</span></span>
<span><span class="op">)</span></span>
<span><span class="va">predictedSensitivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    NumberSamples <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">csc</span><span class="op">$</span><span class="va">NumberSamples</span><span class="op">)</span> </span>
<span><span class="op">)</span></span>
<span><span class="va">predictedSensitivity</span><span class="op">$</span><span class="va">Sensitivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>    <span class="va">AsymptoticRegressionModel</span>,</span>
<span>    newdata <span class="op">=</span> <span class="va">predictedSensitivity</span></span>
<span><span class="op">)</span></span>
<span><span class="va">plCumS</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predictedSensitivity</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reporting_missing_values_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>We finally compute the predicted total sensitivity, that is
sensitivity if we had an infinite number of samples.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>    <span class="va">AsymptoticRegressionModel</span>,</span>
<span>    newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NumberSamples <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span> </span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7294.176</span></span>
<span><span class="co">#&gt; attr(,"gradient")</span></span>
<span><span class="co">#&gt;      Asym R0 lrc</span></span>
<span><span class="co">#&gt; [1,]    1  0 NaN</span></span></code></pre></div>
<p>The total sensitivity is predicted to be 7282 peptides. Compared to
the total sensitivity of 7111 reported in the previous section, we
underestimate the total sensitivity by about 150 peptides.</p>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"scp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; To cite the scp package in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Vanderaa Christophe and Laurent Gatto. Revisiting the thorny issue of</span></span>
<span><span class="co">#&gt;   missing values in single-cell proteomics. arXiv:2304.06654; doi:</span></span>
<span><span class="co">#&gt;   https://doi.org/2304.06654 (2023).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Vanderaa Christophe and Laurent Gatto. The current state of</span></span>
<span><span class="co">#&gt;   single-cell proteomics data analysis. Current Protocols 3 (1): e658.;</span></span>
<span><span class="co">#&gt;   doi: https://doi.org/10.1002/cpz1.658 (2023).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Vanderaa Christophe and Laurent Gatto. Replication of Single-Cell</span></span>
<span><span class="co">#&gt;   Proteomics Data Reveals Important Computational Challenges. Expert</span></span>
<span><span class="co">#&gt;   Review of Proteomics, 1–9 (2021).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see these entries in BibTeX format, use 'print(&lt;citation&gt;,</span></span>
<span><span class="co">#&gt; bibtex=TRUE)', 'toBibtex(.)', or set</span></span>
<span><span class="co">#&gt; 'options(citation.bibtex.max=999)'.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This vignette is distributed under a <a href="https://creativecommons.org/licenses/by-sa/2.0/" class="external-link">CC BY-SA
license</a> license.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Vanderaa2023-gu" class="csl-entry">
Vanderaa, Christophe, and Laurent Gatto. 2023. <span>“Revisiting the
Thorny Issue of Missing Values in Single-Cell Proteomics,”</span> April.
<a href="https://arxiv.org/abs/2304.06654" class="external-link">https://arxiv.org/abs/2304.06654</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christophe Vanderaa, Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
