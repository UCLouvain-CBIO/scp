<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Modelling single-cell proteomics data — ScpModel-Workflow • scp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Modelling single-cell proteomics data — ScpModel-Workflow"><meta property="og:description" content="Function to estimate a linear model for each feature (peptide or
protein) of a single-cell proteomics data set."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/scp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/advanced.html">Advanced usage of `scp`</a>
    </li>
    <li>
      <a href="../articles/QFeatures_nutshell.html">QFeatures in a nutshell</a>
    </li>
    <li>
      <a href="../articles/read_scp.html">Load Single-Cell Proteomics data using `readSCP`</a>
    </li>
    <li>
      <a href="../articles/reporting_missing_values.html">Reporting missing values for Single Cell Proteomics</a>
    </li>
    <li>
      <a href="../articles/scp_data_modelling.html">Single Cell Proteomics data modelling</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/UCLouvain-CBIO/scp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Modelling single-cell proteomics data</h1>
    <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/scp/blob/master/R/ScpModel-Workflow.R" class="external-link"><code>R/ScpModel-Workflow.R</code></a></small>
    <div class="hidden name"><code>ScpModel-Workflow.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to estimate a linear model for each feature (peptide or
protein) of a single-cell proteomics data set.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">scpModelWorkflow</span><span class="op">(</span><span class="va">object</span>, <span class="va">formula</span>, i <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"model"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scpModelFilterPlot</span><span class="op">(</span><span class="va">object</span>, <span class="va">name</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object that inherits from the
<code>SingleCellExperiment</code> class.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A <code>formula</code> object controlling which variables are
to be modelled.</p></dd>


<dt id="arg-i">i<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>A <code>logical</code>, <code>numeric</code> or <code>character</code> indicating which
assay of <code>object</code> to use as input for modelling. Only a single
assay can be provided. Defaults to the first assays.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>A <code>character(1)</code> providing the name to use to store or
retrieve the modelling results. When retrieving a model and
<code>name</code> is missing, the name of the first model found in
<code>object</code> is used.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A <code>logical(1)</code> indicating whether to print progress
to the console.</p></dd>

</dl></div>
    <div id="input-data">
    <h2>Input data</h2>



<p>The main input is <code>object</code> that inherits from the
<code>SingleCellExperiment</code> class. The quantitative data will be
retrieve using <code>assay(object)</code>. If <code>object</code> contains multiple
assays, you can specify which assay to take as input thanks to the
argument <code>i</code>, the function will then assume <code>assay(object, i)</code> as
quantification input .</p>
<p>The objective of modelling single-cell proteomics data is to
estimate, for each feature (peptide or protein), the effect of
known cell annotations on the measured intensities. These annotations
may contain biological information such as the cell line,
FACS-derived cell type, treatment, etc. We also highly recommend
including technical information, such as the MS acquisition run
information or the chemical label (in case of multiplexed
experiments). These annotation must be available from
<code>colData(object)</code>. <code>formula</code> specifies which annotations to use
during modelling.</p>
    </div>
    <div id="data-modelling-workflow">
    <h2>Data modelling workflow</h2>



<p>The modelling worflow starts with generating a model matrix for
each feature given the <code>colData(object)</code> and <code>formula</code>. The model
matrix for peptide \(i\), denoted \(X_i\), is adapted to the
pattern of missing values (see section below). Then, the functions
fits the model matrix against the quantitative data. In other
words, the function determines for each feature \(i\) (row in
the input data) the contribution of each variable in the model.
More formally, the general model definition is:</p>
<p>$$Y_i = \beta_i X^T_{(i)} + \epsilon_i$$</p>
<p>where \(Y\) is the feature by cell quantification matrix,
\(\beta_i\) contains the estimated coefficients for feature
\(i\) with as many coefficients as variables to estimate,
\(X^T_{(i)}\) is the model matrix generated for feature \(i\),
and \(\epsilon\) is the feature by cell matrix with
residuals.</p>
<p>The coefficients are estimated using penalized least squares
regression. Next, the function computes the residual matrix and
the effect matrices. An effect matrix contains the data that is
captured by a given cell annotation. Formally, for each feature
\(i\):</p>
<p>$$\hat{M^f_i} = \hat{\beta^f_i} X^{fT}_{(i)} $$</p>
<p>where \(\hat{M^f}\) is a cell by feature matrix containing the
variables associated to annotation \(f\), \(\hat{\beta^f_i}\)
are the estimated coefficients associated to annotation \(f\)
and estimated for feature \(i\), and \(X^{fT}_{(i)}\) is the
model matrix for peptide \(i\) containing only the variables to
annotation \(f\).</p>
<p>All the results are stored in an <a href="ScpModel-class.html">ScpModel</a> object which is stored
in the <code>object</code>'s metadata. Note that multiple models can be
estimated for the same <code>object</code>. In that case, provide the <code>name</code>
argument to store the results in a separate <code>ScpModel</code>.</p>
    </div>
    <div id="feature-filtering">
    <h2>Feature filtering</h2>



<p>The proportion of missing values for each features is high in
single-cell proteomics data. Many features can typically contain
more coefficients to estimate than observed values. These features
cannot be estimated and will be ignored during further steps.
These features are identified by computing the ratio between the
number of observed values and the number of coefficients to
estimate. We call it the <strong>n/p ratio</strong>. Once the model is
estimated, use <code>scpModelFilterPlot(object)</code> to explore the
distribution of n/p ratios across the features. You can also
extract the n/p ratio for each feature using
<code>scpModelFilterNPRatio(object)</code>. By default, any feature that has
an n/p ratio lower than 1 is ignored. However, feature with an
n/p ratio close to 1 may lead to unreliable outcome because there
are not enough observed data. You could consider the n/p ratio as
the average number of replicate per coefficient to estimate.
Therefore, you may want to increase the n/p threshold. You can do
so using <code>scpModelFilter(object) &lt;- npThreshold</code>.</p>
    </div>
    <div id="about-missing-values">
    <h2>About missing values</h2>



<p>The data modelling workflow is designed to take the presence of
missing values into account. We highly recommend to <strong>not impute</strong>
the data before modelling. Instead, the modelling approach will
ignore missing values and will generate a model matrix using only
the observed values for each feature. However, the model matrices
for some features may contain highly correlated variables, leading
to near singular designs. We include a small ridge penalty to
reduce numerical instability associated to correlated variables.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><a href="ScpModel-class.html">ScpModel</a> for functions to extract information from the
<code>ScpModel</code> object</p></li>
<li><p><a href="ScpModel-VarianceAnalysis.html">ScpModel-VarianceAnalysis</a>, <a href="ScpModel-DifferentialAnalysis.html">ScpModel-DifferentialAnalysis</a>,
<a href="ScpModel-ComponentAnalysis.html">ScpModel-ComponentAnalysis</a> to explore the model results</p></li>
<li><p><a href="ScpModel-DataCorrection.html">scpKeepEffect</a> and <a href="ScpModel-DataCorrection.html">scpRemoveBatchEffect</a> to perform batch
correction for downstream analyses.</p></li>
</ul></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Christophe Vanderaa, Laurent Gatto</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"leduc_minimal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">leduc_minimal</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SingleCellExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 200 73 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(1): model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): ''</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(200): SAVEDEGLK APNVVVTR ... FLLAVSRDR EASMVITESPAALQLR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(6): Sequence Reverse ... Leading.razor.protein.symbol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gene</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(73): eAL00219RI5 eAL00219RI6 ... wAL00286RI17 wAL00286RI18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(12): Set Channel ... MedianCV passQC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reducedDimNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mainExpName: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> altExpNames(0):</span>
<span class="r-in"><span><span class="co">## Overview of available cell annotations</span></span></span>
<span class="r-in"><span><span class="fu">colData</span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 73 rows and 12 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Set  Channel SampleAnnotation  SampleType     lcbatch</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              &lt;character&gt; &lt;factor&gt;      &lt;character&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI5     eAL00219  TMT128C                u    Monocyte           C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI6     eAL00219  TMT129N                u    Monocyte           C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI7     eAL00219  TMT129C                u    Monocyte           C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI8     eAL00219  TMT130N                u    Monocyte           C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI9     eAL00219  TMT130C                u    Monocyte           C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                  ...      ...              ...         ...         ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI12    wAL00286  TMT132N                u    Monocyte           A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI14    wAL00286  TMT133N                u    Monocyte           A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI16    wAL00286  TMT134N                m    Melanoma           A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI17    wAL00286  TMT134C                m    Melanoma           A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI18    wAL00286  TMT135N                m    Melanoma           A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  sortday      digest MelanomaSubCluster NumberPeptides</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              &lt;character&gt; &lt;character&gt;        &lt;character&gt;      &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI5            B          88                 NA           2869</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI6            B          88                 NA           2752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI7            B          88                 NA           2605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI8            B          88                 NA           2533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI9            B          88                 NA           2934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                  ...         ...                ...            ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI12           B          87                 NA           2240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI14           B          87                 NA           2052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI16           B          87                  A           2533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI17           B          87                  A           2480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI18           B          87                  A           2546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              MedianIntensity  MedianCV    passQC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    &lt;numeric&gt; &lt;numeric&gt; &lt;logical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI5          7.28653  0.486676      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI6          7.20664  0.466900      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI7          7.11200  0.459270      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI8          7.05177  0.468643      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eAL00219RI9          7.37988  0.507540      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...                      ...       ...       ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI12         6.89256  0.565737      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI14         6.88984  0.479487      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI16         7.15227  0.478197      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI17         7.08841  0.457700      TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wAL00286RI18         7.02233  0.451006      TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- Model data ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="co">## intercept</span></span></span>
<span class="r-in"><span>    <span class="va">Channel</span> <span class="op">+</span> <span class="va">Set</span> <span class="op">+</span> <span class="co">## batch variables</span></span></span>
<span class="r-in"><span>    <span class="va">MedianIntensity</span> <span class="op">+</span><span class="co">## normalization</span></span></span>
<span class="r-in"><span>    <span class="va">SampleType</span> <span class="co">## biological variable</span></span></span>
<span class="r-in"><span><span class="va">leduc_minimal</span> <span class="op">&lt;-</span> <span class="fu">scpModelWorkflow</span><span class="op">(</span><span class="va">leduc_minimal</span>, formula <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>An element called 'model' is already present in the metadata. The associated content will be overwritten.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- n/p feature filtering ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Get n/p ratios</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="ScpModel-class.html">scpModelFilterNPRatio</a></span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      SAVEDEGLK       APNVVVTR      IVVVTAGVR GFQEVVTPNIFNSR ENAYDLEANLAVLK </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1.277778       3.476190       1.411765       2.333333       1.235294 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      IGPLGLSPK </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1.888889 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot n/p ratios</span></span></span>
<span class="r-in"><span><span class="fu">scpModelFilterPlot</span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To change the threshold, use:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> scpModelFilterThreshold(object, name) &lt;- threshold</span>
<span class="r-plt img"><img src="ScpModel-Workflow-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Change n/p ratio threshold</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ScpModel-class.html">scpModelFilterThreshold</a></span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="fu">scpModelFilterPlot</span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> To change the threshold, use:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> scpModelFilterThreshold(object, name) &lt;- threshold</span>
<span class="r-plt img"><img src="ScpModel-Workflow-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christophe Vanderaa, Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer></div>






  </body></html>

