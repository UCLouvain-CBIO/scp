<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Analysis of variance for single-cell proteomics — ScpModel-VarianceAnalysis • scp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of variance for single-cell proteomics — ScpModel-VarianceAnalysis"><meta property="og:description" content="Analysis of variance investigates the contribution of each effects
in capturing the variance in the data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/scp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/advanced.html">Advanced usage of `scp`</a>
    </li>
    <li>
      <a href="../articles/QFeatures_nutshell.html">QFeatures in a nutshell</a>
    </li>
    <li>
      <a href="../articles/read_scp.html">Load Single-Cell Proteomics data using `readSCP`</a>
    </li>
    <li>
      <a href="../articles/reporting_missing_values.html">Reporting missing values for Single Cell Proteomics</a>
    </li>
    <li>
      <a href="../articles/scp_data_modelling.html">Single Cell Proteomics data modelling</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/UCLouvain-CBIO/scp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Analysis of variance for single-cell proteomics</h1>
    <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/scp/blob/master/R/ScpModel-VarianceAnalysis.R" class="external-link"><code>R/ScpModel-VarianceAnalysis.R</code></a></small>
    <div class="hidden name"><code>ScpModel-VarianceAnalysis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Analysis of variance investigates the contribution of each effects
in capturing the variance in the data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">scpVarianceAnalysis</span><span class="op">(</span><span class="va">object</span>, <span class="va">name</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scpVarianceAggregate</span><span class="op">(</span><span class="va">varianceList</span>, <span class="va">fcol</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scpVariancePlot</span><span class="op">(</span></span>
<span>  <span class="va">varianceList</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"Residuals"</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"percentExplainedVar"</span>,</span>
<span>  top <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  decreasing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  combined <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fcol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colourSeed <span class="op">=</span> <span class="fl">1234</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object that inherits from the
<code>SingleCellExperiment</code> class. It must contain an estimated
<code>ScpModel</code> in its metadata.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>A <code>character(1)</code> providing the name to use to retrieve
the model results. When retrieving a model and <code>name</code> is
missing, the name of the first model found in <code>object</code> is used.</p></dd>


<dt id="arg-variancelist">varianceList<a class="anchor" aria-label="anchor" href="#arg-variancelist"></a></dt>
<dd><p>A list of tables returned by
<code>scpVarianceAnalysis()</code>.</p></dd>


<dt id="arg-fcol">fcol<a class="anchor" aria-label="anchor" href="#arg-fcol"></a></dt>
<dd><p>A <code>character(1)</code> indicating the column to use for
grouping features. Typically, this would be protein or gene
names for grouping proteins.</p></dd>


<dt id="arg-effect">effect<a class="anchor" aria-label="anchor" href="#arg-effect"></a></dt>
<dd><p>A <code>character(1)</code> used to filter theb results. It
indicates which effect should be considered when sorting the
results.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A <code>character(1)</code> used to filter the results. It
indicates which variable should be considered when sorting the
results. Can be one of: "SS", "df", or "percentExplainedVar".</p></dd>


<dt id="arg-top">top<a class="anchor" aria-label="anchor" href="#arg-top"></a></dt>
<dd><p>A <code>numeric(1)</code> used to filter the results. It indicates how
many features should be plotted. When <code>top = Inf</code> (default),
all feature are considered.</p></dd>


<dt id="arg-decreasing">decreasing<a class="anchor" aria-label="anchor" href="#arg-decreasing"></a></dt>
<dd><p>A <code>logical(1)</code> indicating whether the effects
should be ordered decreasingly (<code>TRUE</code>, default) or
increasingly (<code>FALSE</code>) depending on the value provided by
<code>by</code>.</p></dd>


<dt id="arg-combined">combined<a class="anchor" aria-label="anchor" href="#arg-combined"></a></dt>
<dd><p>A <code>logical(1)</code> indicating whether the results
should be combined across all features. When <code>TRUE</code>, the
barplot shows the explained variance for the complete dataset.</p></dd>


<dt id="arg-colourseed">colourSeed<a class="anchor" aria-label="anchor" href="#arg-colourseed"></a></dt>
<dd><p>A <code>integer(1)</code> providing a seed that is used
when randomly sampling colours for the effects. Change the
number to generate another colour scheme.</p></dd>

</dl></div>
    <div id="running-the-variance-analysis">
    <h2>Running the variance analysis</h2>



<p><code>scpVarianceAnalysis()</code> computes the amount of data (measured as
the sums of squares) that is captured by each model variable, but
also that is not modelled and hence captured in the residuals. The
proportion of variance explained by each effect is the sums of
squares for that effect divided by the sum of all sums of squares
for each effect and residuals. This is computed for each feature
separately. The function returns a list of <code>DataFrame</code>s with one
table for each effect.</p>
<p><code>scpVarianceAggregate()</code> combines the analysis of variance results
for groups of features. This is useful, for example, to
return protein-level results when data is modelled at the peptide
level. The function takes the list of tables generated by
<code>scpVarianceAnalysis()</code> and returns a new list of <code>DataFrame</code>s
with aggregated results.</p>
    </div>
    <div id="exploring-variance-analysis-results">
    <h2>Exploring variance analysis results</h2>



<p><code><a href="scpAnnotateResults.html">scpAnnotateResults()</a></code> adds annotations to the component
analysis results. The annotations are added to all elements of the
list returned by <code><a href="ScpModel-ComponentAnalysis.html">scpComponentAnalysis()</a></code>. See the associated man
page for more information.</p>
<p><code>scpVariancePlot()</code> takes the list of tables generated by
<code>scpVarianceAnalysis()</code> and returns a <code>ggplot2</code> bar plot. The
bar plot shows the proportion of explained variance by each effect
and the residual variance. By default, the function will combine
the results over all features, showing the effect's contributions
on the complete data set. When <code>combine = FALSE</code>, the results
are shown for individual features, with additional arguments to
control how many and which features are shown. Bars can also be
grouped by <code>fcol</code>. This is particularly useful when exploring
peptide level results, but grouping peptides that belong to the
same protein (note that you should not use <code>scpVarianceAggregate()</code>
in that case).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><a href="ScpModel-Workflow.html">ScpModel-Workflow</a> to run a model on SCP data upstream of
analysis of variance.</p></li>
<li><p><code><a href="scpAnnotateResults.html">scpAnnotateResults()</a></code> to annotate analysis of variance results.</p></li>
</ul></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Christophe Vanderaa, Laurent Gatto</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"leduc_minimal"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- Run analysis of variance ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">scpVarianceAnalysis</span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrameList of length 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(5): Residuals Channel Set MedianIntensity SampleType</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- Annotate results ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add peptide annotations available from the rowData</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="scpAnnotateResults.html">scpAnnotateResults</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">var</span>, <span class="fu">rowData</span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"feature"</span>, by2 <span class="op">=</span> <span class="st">"Sequence"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- Plot results ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the analysis of variance through the whole data</span></span></span>
<span class="r-in"><span><span class="fu">scpVariancePlot</span><span class="op">(</span><span class="va">var</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ScpModel-VarianceAnalysis-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the analysis of variance for the top 20 peptides with highest</span></span></span>
<span class="r-in"><span><span class="co">## percentage of variance explained by the cell type</span></span></span>
<span class="r-in"><span><span class="fu">scpVariancePlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">var</span>, effect <span class="op">=</span> <span class="st">"SampleType"</span>, top <span class="op">=</span> <span class="fl">20</span>, combined <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ScpModel-VarianceAnalysis-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Same but grouped by protein</span></span></span>
<span class="r-in"><span><span class="fu">scpVariancePlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">var</span>, effect <span class="op">=</span> <span class="st">"SampleType"</span>, top <span class="op">=</span> <span class="fl">20</span>, combined <span class="op">=</span> <span class="cn">FALSE</span>, fcol <span class="op">=</span> <span class="st">"gene"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ScpModel-VarianceAnalysis-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- Aggregate results ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Aggregate to protein-level results</span></span></span>
<span class="r-in"><span><span class="va">varProtein</span> <span class="op">&lt;-</span> <span class="fu">scpVarianceAggregate</span><span class="op">(</span><span class="va">var</span>, fcol <span class="op">=</span> <span class="st">"gene"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">scpVariancePlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">varProtein</span>, effect <span class="op">=</span> <span class="st">"SampleType"</span>, top <span class="op">=</span> <span class="fl">20</span>, combined <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ScpModel-VarianceAnalysis-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christophe Vanderaa, Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer></div>






  </body></html>

