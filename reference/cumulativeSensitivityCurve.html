<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Cumulative sensitivity curve — cumulativeSensitivityCurve • scp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Cumulative sensitivity curve — cumulativeSensitivityCurve"><meta property="og:description" content="The cumulative sensitivity curve is used to evaluate if the sample
size is sufficient to accurately estimate the total sensitivity.
If it is not the case, an asymptotic regression model may provide
a prediction of the total sensitivity if more samples would have
been acquired."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/scp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/advanced.html">Advanced usage of `scp`</a>
    </li>
    <li>
      <a href="../articles/QFeatures_nutshell.html">QFeatures in a nutshell</a>
    </li>
    <li>
      <a href="../articles/read_scp.html">Load Single-Cell Proteomics data using `readSCP`</a>
    </li>
    <li>
      <a href="../articles/reporting_missing_values.html">Reporting missing values for Single Cell Proteomics</a>
    </li>
    <li>
      <a href="../articles/scp_data_modelling.html">Single Cell Proteomics data modelling</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/UCLouvain-CBIO/scp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cumulative sensitivity curve</h1>
    <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/scp/blob/master/R/compute_metrics.R" class="external-link"><code>R/compute_metrics.R</code></a></small>
    <div class="hidden name"><code>cumulativeSensitivityCurve.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The cumulative sensitivity curve is used to evaluate if the sample
size is sufficient to accurately estimate the total sensitivity.
If it is not the case, an asymptotic regression model may provide
a prediction of the total sensitivity if more samples would have
been acquired.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cumulativeSensitivityCurve</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">i</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nsteps <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  niters <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">predictSensitivity</span><span class="op">(</span><span class="va">df</span>, <span class="va">nSamples</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class QFeatures.</p></dd>


<dt id="arg-i">i<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>The index of the assay in <code>object</code>. The assay must
contain an identification matrix, that is a matrix where an
entry is <code>TRUE</code> if the value is observed and <code>FALSE</code> is the
value is missing (see examples).</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A vector of length equal to the number of columns in
assay <code>i</code> that defines groups for a cumulative sensitivity
curve will be computed separately. If missing, the sensitivity
curve is computed for the completd dataset.</p></dd>


<dt id="arg-batch">batch<a class="anchor" aria-label="anchor" href="#arg-batch"></a></dt>
<dd><p>A vector of length equal to the number of columns in
assay <code>i</code> that defines the cell batches. All cells in a batch
will be aggregated to a single sample.</p></dd>


<dt id="arg-nsteps">nsteps<a class="anchor" aria-label="anchor" href="#arg-nsteps"></a></dt>
<dd><p>The number of equally spaced sample sizes to compute
the sensitivity.</p></dd>


<dt id="arg-niters">niters<a class="anchor" aria-label="anchor" href="#arg-niters"></a></dt>
<dd><p>The number of iteration to compute</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>The output from <code>cumulativeSensitivityCurve()</code>.</p></dd>


<dt id="arg-nsamples">nSamples<a class="anchor" aria-label="anchor" href="#arg-nsamples"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> of samples sizes. If <code>Inf</code>, the
prediction provides the extrapolated total sensitivity.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>data.frame</code> with groups as many rows as pairs of cells
and the following column(s):</p><ul><li><p><code>jaccard</code>: the computed Jaccard index</p></li>
<li><p><code>by</code>: if <code>by</code> is not <code>NULL</code>, the group of the pair of cells
for which the Jaccard index is computed.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>As more samples are added to a dataset, the total number of
distinct features increases. When sufficient number of samples are
acquired, all peptides that are identifiable by the technology and
increasing the sample size no longer increases the set of
identified features. The cumulative sensitivity curve depicts the
relationship between sensitivity (number of distinct peptides in
the data) and the sample size. More precisely, the curve is built
by sampling cells in the data and count the number of distinct
features found across the sampled cells. The sampling is repeated
multiple times to account for the stochasticity of the approach.
Datasets that have a sample size sufficiently large should have a
cumulative sensitivity curve with a plateau.</p>
<p>The set of features present in a cell depends on the cell type.
Therefore, we suggest to build the cumulative sensitivity curve
for each cell type separately. This is possible when providing the
<code>by</code> argument.</p>
<p>For multiplexed experiments, several cells are acquired in a run.
In that case, when a features is identified in a cell, it is
frequently also identified in all other cells of that run, and
this will distort the cumulative sensitivity curve. Therefore, the
function allows to compute the cumulative sensitivity curve at the
batches level rather than at the cell level. This is possible when
providing the <code>batch</code> argument.</p>
<p>Once the cumulative sensitivity curve is computed, the returned
data can be visualized to explore the relationship between the
sensitivity and the sample size. If enough samples are acquired,
the curve should plateau at high numbers of samples. If it is not
the case, the total sensitivity can be predicted using an
asymptotic regression curve. To predict the total sensitivity, the
model is extrapolated to infinite sample size. Therefore, the
accuracy of the extrapolation will highly depend on the available
data. The closer the curve is to the plateau, the more accurate
the prediction.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate data</span></span></span>
<span class="r-in"><span><span class="co">## 1000 features in 100 cells</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fl">1000</span>, <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">id</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, <span class="fl">5000</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"feat"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span>assays <span class="op">=</span> <span class="fu">List</span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="op">(</span>experiments <span class="op">=</span> <span class="fu">List</span><span class="op">(</span>id <span class="op">=</span> <span class="va">sce</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span><span class="op">$</span><span class="va">batch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span><span class="op">$</span><span class="va">SampleType</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 1 assays:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] id: SingleCellExperiment with 1000 rows and 1000 columns </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compute the cumulative sensitivity curve, take batch and sample</span></span></span>
<span class="r-in"><span><span class="co">## type into account</span></span></span>
<span class="r-in"><span><span class="va">csc</span> <span class="op">&lt;-</span> <span class="fu">cumulativeSensitivityCurve</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">sim</span>, <span class="st">"id"</span>, by <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">SampleType</span>,</span></span>
<span class="r-in"><span>    batch <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">batch</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">predCSC</span> <span class="op">&lt;-</span> <span class="fu">predictSensitivity</span><span class="op">(</span><span class="va">csc</span>, nSample <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">csc</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SampleSize</span>, y <span class="op">=</span> <span class="va">Sensitivity</span>, colour <span class="op">=</span> <span class="va">by</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predCSC</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cumulativeSensitivityCurve-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extrapolate the total sensitivity</span></span></span>
<span class="r-in"><span><span class="fu">predictSensitivity</span><span class="op">(</span><span class="va">csc</span>, nSamples <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SampleSize Sensitivity by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        Inf   1001.5121  A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        Inf    990.6431  B</span>
<span class="r-in"><span><span class="co">## (real total sensitivity = 1000)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christophe Vanderaa, Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

      </footer></div>






  </body></html>

