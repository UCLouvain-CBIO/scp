<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Correct single-cell proteomics data — ScpModel-DataCorrection • scp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Correct single-cell proteomics data — ScpModel-DataCorrection"><meta property="og:description" content="The function uses the data modelling output to generate corrected
data that can be used for downstream analysis. The input
is expected to be a SingleCellExperiment object that contains an
estimated ScpModel. There are two approaches:
scpKeepEffect(): keep the effects of interests. The
reconstructed data is the sum of the effect matrices for the
variable of interest and the residuals. Note that the intercepts
(baseline intensity of each feature) are not included by
default, but they can be added when intercept = TRUE.
scpRemoveBatchEffect(): remove any undesired effect. The batch
corrected data is the input data minus the effect matrices that
correspond to batch effect variables. Note that the intercepts
(baseline intensity of each feature) are removed by default, but
they can be kept when intercept = FALSE.


Despite the two approaches are conceptually different, they can
lead to similar results if the effects that are used to
reconstruct the data are the ones that are not removed when
performing batch correction (see examples).
The function returns a new SingleCellExperiment that contains an
assay with the batch corrected data. Note that the 'ScpModel` is
erased in this new object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/scp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/advanced.html">Advanced usage of `scp`</a>
    </li>
    <li>
      <a href="../articles/QFeatures_nutshell.html">QFeatures in a nutshell</a>
    </li>
    <li>
      <a href="../articles/read_scp.html">Load Single-Cell Proteomics data using `readSCP`</a>
    </li>
    <li>
      <a href="../articles/reporting_missing_values.html">Reporting missing values for Single Cell Proteomics</a>
    </li>
    <li>
      <a href="../articles/scp_data_modelling.html">Single Cell Proteomics data modelling</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/UCLouvain-CBIO/scp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Correct single-cell proteomics data</h1>
    <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/scp/blob/master/R/ScpModel-Utils.R" class="external-link"><code>R/ScpModel-Utils.R</code></a></small>
    <div class="hidden name"><code>ScpModel-DataCorrection.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function uses the data modelling output to generate corrected
data that can be used for downstream analysis. The input
is expected to be a <code>SingleCellExperiment</code> object that contains an
estimated <code>ScpModel</code>. There are two approaches:</p><ul><li><p><code>scpKeepEffect()</code>: keep the effects of interests. The
reconstructed data is the sum of the effect matrices for the
variable of interest and the residuals. Note that the intercepts
(baseline intensity of each feature) are not included by
default, but they can be added when <code>intercept = TRUE</code>.</p></li>
<li><p><code>scpRemoveBatchEffect()</code>: remove any undesired effect. The batch
corrected data is the input data minus the effect matrices that
correspond to batch effect variables. Note that the intercepts
(baseline intensity of each feature) are removed by default, but
they can be kept when <code>intercept = FALSE</code>.</p></li>
</ul><p>Despite the two approaches are conceptually different, they can
lead to similar results if the effects that are used to
reconstruct the data are the ones that are not removed when
performing batch correction (see examples).</p>
<p>The function returns a new <code>SingleCellExperiment</code> that contains an
assay with the batch corrected data. Note that the 'ScpModel` is
erased in this new object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">scpKeepEffect</span><span class="op">(</span><span class="va">object</span>, effects <span class="op">=</span> <span class="cn">NULL</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">name</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scpRemoveBatchEffect</span><span class="op">(</span><span class="va">object</span>, effects <span class="op">=</span> <span class="cn">NULL</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">name</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object that inherits from the
<code>SingleCellExperiment</code> class. It must contain an estimated
<code>ScpModel</code> in its metadata</p></dd>


<dt id="arg-effects">effects<a class="anchor" aria-label="anchor" href="#arg-effects"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> vector. For <code>scpKeepEffect()</code>,
which model variable should be used to reconstruct the data.
For <code>scpRemoveBatchEffect()</code>, which model variable should be
removed from the data. When <code>NULL</code> (default), both functions
return the model residuals.</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>A <code>logical(1)</code>. For <code>scpKeepEffect()</code>,
should the intercepts be included when reconstructing the
data? Defaults to <code>FALSE</code>, hence the intercepts are not
included. For <code>scpRemoveBatchEffect()</code>, should the intercepts
be removed from the data? Defaults to <code>TRUE</code>, hence the
intercepts are removed from the data.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>A <code>character(1)</code> providing the name to use to retrieve
the model results. When retrieving a model and <code>name</code> is
missing, the name of the first model found in <code>object</code> is used.</p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><a href="ScpModel-class.html">ScpModel</a> for functions to extract information from the
<code>ScpModel</code> object</p></li>
<li><p><a href="ScpModel-Workflow.html">ScpModel-Workflow</a> to run a model on SCP data required for
batch correction.</p></li>
</ul></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Christophe Vanderaa, Laurent Gatto</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"leduc_minimal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ScpModel-class.html">scpModelFormula</a></span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ~1 + Channel + Set + MedianIntensity + SampleType</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">reconstructed</span> <span class="op">&lt;-</span> <span class="fu">scpKeepEffect</span><span class="op">(</span><span class="va">leduc_minimal</span>, effects <span class="op">=</span> <span class="st">"SampleType"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">batchCorreced</span> <span class="op">&lt;-</span> <span class="fu">scpRemoveBatchEffect</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">leduc_minimal</span>, effects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Channel"</span>, <span class="st">"Set"</span>, <span class="st">"MedianIntensity"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## The two approaches are identical</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">reconstructed</span>, <span class="va">batchCorreced</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christophe Vanderaa, Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer></div>






  </body></html>

