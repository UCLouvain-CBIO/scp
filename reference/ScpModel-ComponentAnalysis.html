<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Component analysis for single cell proteomics — scpModelComponentMethods • scp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Component analysis for single cell proteomics — scpModelComponentMethods"><meta property="og:description" content="Component analysis is a powerful tool for exploring data. The
package implements the ANOVA-principal component analysis
extended to linear models (APCA+) and derivatives (suggested by
Thiel at al. 2017). This framework is based on principal component
analysis (PCA) and allows exploring the data captured by each
model variable individually."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/scp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/advanced.html">Advanced usage of `scp`</a>
    </li>
    <li>
      <a href="../articles/QFeatures_nutshell.html">QFeatures in a nutshell</a>
    </li>
    <li>
      <a href="../articles/read_scp.html">Load Single-Cell Proteomics data using `readSCP`</a>
    </li>
    <li>
      <a href="../articles/reporting_missing_values.html">Reporting missing values for Single Cell Proteomics</a>
    </li>
    <li>
      <a href="../articles/scp_data_modelling.html">Single Cell Proteomics data modelling</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/UCLouvain-CBIO/scp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Component analysis for single cell proteomics</h1>
    <small class="dont-index">Source: <a href="https://github.com/UCLouvain-CBIO/scp/blob/master/R/ScpModel-Class.R" class="external-link"><code>R/ScpModel-Class.R</code></a>, <a href="https://github.com/UCLouvain-CBIO/scp/blob/master/R/ScpModel-ComponentAnalysis.R" class="external-link"><code>R/ScpModel-ComponentAnalysis.R</code></a></small>
    <div class="hidden name"><code>ScpModel-ComponentAnalysis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Component analysis is a powerful tool for exploring data. The
package implements the ANOVA-principal component analysis
extended to linear models (APCA+) and derivatives (suggested by
Thiel at al. 2017). This framework is based on principal component
analysis (PCA) and allows exploring the data captured by each
model variable individually.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="va">scpModelComponentMethods</span></span>
<span></span>
<span><span class="fu">scpComponentAnalysis</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  effects <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pcaFUN <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  residuals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  unmodelled <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scpComponentAggregate</span><span class="op">(</span><span class="va">componentList</span>, <span class="va">fcol</span>, fun <span class="op">=</span> <span class="va">colMedians</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scpComponentPlot</span><span class="op">(</span></span>
<span>  <span class="va">componentList</span>,</span>
<span>  comp <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>  pointParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  maxLevels <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scpComponentBiplot</span><span class="op">(</span></span>
<span>  <span class="va">scoreList</span>,</span>
<span>  <span class="va">eigenvectorList</span>,</span>
<span>  comp <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>  pointParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  arrowParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>arrow <span class="op">=</span> <span class="fu">arrow</span><span class="op">(</span>length <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  labelParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, max.overlaps <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  textBy <span class="op">=</span> <span class="st">"feature"</span>,</span>
<span>  top <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxLevels <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="format">
    <h2>Format</h2>
    <p>An object of class <code>character</code> of length 3.</p>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object that inherits from the
<code>SingleCellExperiment</code> class. It must contain an estimated
<code>ScpModel</code> in its metadata.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> indicating which approach(es) to use
for principal component analysis (PCA). Are allowed:
<code>"APCA"</code> (default), <code>"ASCA"</code> and/or <code>"ASCA.E"</code> (multiple
values are allowed). <code>"ASCA"</code>, <code>"APCA"</code>, <code>"ASCA.E"</code> are
iterated through each desired effects.</p></dd>


<dt id="arg-effects">effects<a class="anchor" aria-label="anchor" href="#arg-effects"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> indicating on which model variables
the component analysis should be performed. Default to all
modelled variables.</p></dd>


<dt id="arg-pcafun">pcaFUN<a class="anchor" aria-label="anchor" href="#arg-pcafun"></a></dt>
<dd><p>A <code>character(1)</code> indicating which function to use to
perform PCA. "nipals" will use <code><a href="https://kwstat.github.io/nipals/reference/nipals.html" class="external-link">nipals::nipals()</a></code> while "svd"
will use <code><a href="https://rdrr.io/r/base/svd.html" class="external-link">base::svd()</a></code>. If "auto", the function uses "nipals"
if the data contain missing values and "svd" otherwise.</p></dd>


<dt id="arg-residuals">residuals<a class="anchor" aria-label="anchor" href="#arg-residuals"></a></dt>
<dd><p>A <code>logical(1)</code>, if <code>TRUE</code>, PCA is performed on
the residual matrix as well.</p></dd>


<dt id="arg-unmodelled">unmodelled<a class="anchor" aria-label="anchor" href="#arg-unmodelled"></a></dt>
<dd><p>A <code>logical(1)</code>, if <code>TRUE</code>, PCA is performed on
the input matrix as well.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>A <code>character(1)</code> providing the name to use to retrieve
the model results. When retrieving a model and <code>name</code> is
missing, the name of the first model found in <code>object</code> is used.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>scpComponentAnalysis()</code>, further arguments passed
to the PCA function. For <code>scpComponentAggregate()</code>, further
arguments passed to <code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">QFeatures::aggregateFeatures()</a></code>.</p></dd>


<dt id="arg-componentlist">componentList<a class="anchor" aria-label="anchor" href="#arg-componentlist"></a></dt>
<dd><p>A list of components analysis results. This
is typically the <code>bySample</code> or <code>byFeature</code> element of the list
returned by <code>scpComponentAnalysis()</code>.</p></dd>


<dt id="arg-fcol">fcol<a class="anchor" aria-label="anchor" href="#arg-fcol"></a></dt>
<dd><p>A <code>character(1)</code> providing the name of the column
to use to group features.</p></dd>


<dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>A <code>function</code> that summarizes the values for each group.
See <code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">QFeatures::aggregateFeatures()</a></code> for a list of available
functions.</p></dd>


<dt id="arg-comp">comp<a class="anchor" aria-label="anchor" href="#arg-comp"></a></dt>
<dd><p>An <code>integer(2)</code> pointing to which components to fit.
The values of <code>comp</code> are not allowed to exceed the number of
computed components in <code>componentList</code>.</p></dd>


<dt id="arg-pointparams">pointParams<a class="anchor" aria-label="anchor" href="#arg-pointparams"></a></dt>
<dd><p>A <code>list</code> where each element is an argument that
is provided to <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">ggplot2::geom_point()</a></code>. This is useful to
change point size, transparency, or assign colour based on an
annotation (see <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">ggplot2::aes()</a></code>).</p></dd>


<dt id="arg-maxlevels">maxLevels<a class="anchor" aria-label="anchor" href="#arg-maxlevels"></a></dt>
<dd><p>An <code>integer(1)</code> indicating how many colour levels
should be shown on the legend when colours are derived from a
discrete factor. If <code>maxLevels = NULL</code>, all levels are shown.
This parameters is useful to colour points based on a factor
with many levels that would otherwise overcrowd the legend.</p></dd>


<dt id="arg-scorelist">scoreList<a class="anchor" aria-label="anchor" href="#arg-scorelist"></a></dt>
<dd><p>A list of components analysis results. This
is typically the <code>bySample</code> element in the list returned by
<code>scpComponentAnalysis()</code>.</p></dd>


<dt id="arg-eigenvectorlist">eigenvectorList<a class="anchor" aria-label="anchor" href="#arg-eigenvectorlist"></a></dt>
<dd><p>A list of components analysis results. This
is typically the <code>byFeature</code> element in the list returned by
<code>scpComponentAnalysis()</code>.</p></dd>


<dt id="arg-arrowparams">arrowParams<a class="anchor" aria-label="anchor" href="#arg-arrowparams"></a></dt>
<dd><p>A <code>list</code> where each element is an argument that
is provided to <code><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">ggplot2::geom_segment()</a></code>. This is useful to
change arrow head style, line width, transparency, or assign
colour based on an annotation (see <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">ggplot2::aes()</a></code>). Note
that changing the 'x', 'y', 'xend', and 'yend' aesthetics is
not allowed.</p></dd>


<dt id="arg-labelparams">labelParams<a class="anchor" aria-label="anchor" href="#arg-labelparams"></a></dt>
<dd><p>A <code>list</code> where each element is an argument that
is provided to <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_label_repel()</a></code>. This is useful
to change  label size, transparency, or assign
colour based on an annotation (see <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">ggplot2::aes()</a></code>). Note
that changing the 'x', 'y', 'xend', and 'yend' aesthetics is
not allowed.</p></dd>


<dt id="arg-textby">textBy<a class="anchor" aria-label="anchor" href="#arg-textby"></a></dt>
<dd><p>A <code>character(1)</code> indicating the name of the column
to use to label arrow heads.</p></dd>


<dt id="arg-top">top<a class="anchor" aria-label="anchor" href="#arg-top"></a></dt>
<dd><p>An <code>integer(1)</code> indicating how many arrows should be
drawn. The arrows are sorted based on their size as determined
by the euclidean distance in the principal component space.</p></dd>

</dl></div>
    <div id="pca-notation-and-algorithms">
    <h2>PCA - notation and algorithms</h2>



<p>Given \(A\) a m x n matrix, PCA can be summarized as the
following decomposition:</p>
<p>$$AA^T / (n - 1) = VLV^T$$</p>
<p>Where \(V\) is a m x k orthogonal matrix, that is \(VV^T = I\),
with k the number of components. \(V\) is called the matrix of
eigenvectors. \(L\) is the k x k diagonal matrix of eigenvalues
that contains the variance associated to each component, ordered
from highest to lowest variance. The unscaled PC scores are given
by \(S = A^TV\).</p>
<p>There are 2 available algorithm to perform PCA:</p><ul><li><p><code>nipals</code>: The non-linear iterative partial least squares
(NIPALS) algorithm <strong>can handle missing values</strong> and
approximates classical PCA, although it does not explicitly
maximize the variance. This is implemented in <code><a href="https://kwstat.github.io/nipals/reference/nipals.html" class="external-link">nipals::nipals()</a></code>.</p></li>
<li><p><code>svd</code>: The singular value decomposition (SVD) is used to perform
an exact PCA, but it <strong>cannot handle missing values</strong>. This is
implemented in <code><a href="https://rdrr.io/r/base/svd.html" class="external-link">base::svd()</a></code>.</p></li>
</ul><p>Which algorithm to use is controlled by the <code>pcaFUN</code> argument, by
default (<code>"auto"</code>), the function automatically uses <code>svd</code> when
there is no missing values and <code>nipals</code> when there is at least
one missing value.</p>
    </div>
    <div id="component-analysis-methods">
    <h2>Component analysis methods</h2>



<p><code>scpComponentAnalysis()</code> performs a PCA on the modelling output.
What modelling output the function will use depends on the
<code>method</code>. The are 3 PCA approaches:</p><ul><li><p><code>ASCA</code> performs a PCA on the effect matrix, that is
\(A = \hat{M_f}\) where \(f\) is one of the effects in the
model. This PCA is useful to explore the modelled effects and
the relationship between different levels of a factor.</p></li>
<li><p><code>ASCA.E</code>: perform PCA on the effect matrix, just like ASCA. The
scores are then updated by projecting the effect matrix added to
the residuals using the eigenvectors, that is
\(scores = (\hat{M_f} + \epsilon)^TV\). This PCA is useful
to explore the modelled effects while blurring these effects
with the unmodelled variability. Note however that for this
approach, the scores are no longer guaranteed to be orthogonal
and the eigenvalues are no longer meaningful. The percentage of
variation should not be interpreted.</p></li>
<li><p><code>APCA</code> (default) performs PCA on the effect matrix plus the
residuals, that is \(A = \hat{M_f} + \epsilon\). This PCA
is useful to explore the modelled effects in relation with the
unmodelled variability that is remaining in the residuals.</p></li>
</ul><p>Available methods are listed in <code>scpModelComponentMethods</code>.
Note that for all three methods, a PCA on the residual matrix is
also performed when <code>residuals = TRUE</code>, that is
\(A = \epsilon = Y - \hat{\beta}X^T\). A PCA on the residuals is
useful to explore residual effects that are not captured by any
effect in the model. Similarly, a PCA on the input data matrix,
that is on the data before modelling is also performed when
<code>unmodelled = TRUE</code>, that is \(A = Y\).</p>
<p><code>scpComponentAnalysis()</code> always returns a list with 2 elements.
The first element, <code>bySample</code> is a list where each element
contains the PC scores for the desired model variable(s). The
second element, <code>byFeature</code> is a list where each element
contains the eigenvectors for the desired model variable(s).</p>
    </div>
    <div id="exploring-component-analysis-results">
    <h2>Exploring component analysis results</h2>



<p><code><a href="scpAnnotateResults.html">scpAnnotateResults()</a></code> adds annotations to the component
analysis results. The annotations are added to all elements of the
list returned by <code>scpComponentAnalysis()</code>. See the associated man
page for more information.</p>
<p><code>scpComponentPlot()</code> takes one of the two elements of the list
generated by <code>scpComponentAnalysis()</code> and returns a list of
<code>ggplot2</code> scatter plots. Commonly, the first two components,
that bear most of the variance, are explored for visualization,
but other components can be explored as well thanks to the <code>comp</code>
argument. Each point represents either a sample or a feature,
depending on the provided component analysis results
(see examples). Change the point aesthetics by providing ggplot
arguments in a list (see examples).</p>
<p><code>scpComponentBiplot()</code> simultaneously explores the PC scores
(sample-space) and the eigenvectors (feature-space). Scores are
shown as points while eigenvectors are shown as arrows. Point
aesthetics and arrow aesthetics can be controlled with the
<code>pointParams</code> and the <code>arrowParams</code> arguments, respectively.
Moreover, arrows are also labelled and label aesthetics can be
controlled using <code>labelParams</code> and <code>textBy</code>. Plotting all
eigenvectors as arrows leads to overcrowded plots. You can limit the plotting to
the top longest arrows (default to the top 10) as defined by the
distance on the two selected PCs.</p>
<p><code>scpComponentAggregate()</code> offers functionality to aggregate the
results from multiple features. This can be used to obtain, for
example, component analysis results for proteins when modelling at
the peptide level. The approach is inspired from
<a href="https://bioconductor.org/packages/release/bioc/html/scuttle.html" class="external-link">scuttle::aggregateAcrossCells()</a>
and combines, for each group, multiple values for each component
using <code><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">QFeatures::aggregateFeatures()</a></code>. By default, values are
aggregated using the median, but <code>QFeatures</code> offers other methods
as well. The annotation of the component results are automatically
aggregated as well. See the <code>aggregateFeatures()</code> man page for
more information on available methods and expected behavior.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Thiel, Michel, Baptiste Féraud, and Bernadette Govaerts. 2017.
"ASCA+ and APCA+: Extensions of ASCA and APCA in the Analysis of
Unbalanced Multifactorial Designs." Journal of Chemometrics 31
(6): e2895.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><a href="ScpModel-Workflow.html">ScpModel-Workflow</a> to run a model on SCP data upstream of
component analysis.</p></li>
<li><p>The <code><a href="https://kwstat.github.io/nipals/reference/nipals.html" class="external-link">nipals::nipals()</a></code> function and package for detailed
information about the algorithm and associated parameters.</p></li>
<li><p>The <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> functions and associated tutorials to
manipulate and save the visualization output</p></li>
<li><p><code><a href="scpAnnotateResults.html">scpAnnotateResults()</a></code> to annotate component analysis results.</p></li>
</ul></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Christophe Vanderaa, Laurent Gatto</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://patchwork.data-imaginist.com" class="external-link">"patchwork"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"leduc_minimal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">leduc_minimal</span><span class="op">$</span><span class="va">cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- Run component analysis ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">pcs</span> <span class="op">&lt;-</span> <span class="fu">scpComponentAnalysis</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">leduc_minimal</span>, method <span class="op">=</span> <span class="st">"ASCA"</span>, effects <span class="op">=</span> <span class="st">"SampleType"</span>,</span></span>
<span class="r-in"><span>    pcaFUN <span class="op">=</span> <span class="st">"auto"</span>, residuals <span class="op">=</span> <span class="cn">FALSE</span>, unmodelled <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of length 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(2): bySample byFeature</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- Annotate results ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add cell annotation available from the colData</span></span></span>
<span class="r-in"><span><span class="va">bySamplePCs</span> <span class="op">&lt;-</span> <span class="fu"><a href="scpAnnotateResults.html">scpAnnotateResults</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">pcs</span><span class="op">$</span><span class="va">bySample</span>, <span class="fu">colData</span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"cell"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add peptide annotations available from the rowData</span></span></span>
<span class="r-in"><span><span class="va">byFeaturePCs</span> <span class="op">&lt;-</span> <span class="fu"><a href="scpAnnotateResults.html">scpAnnotateResults</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">pcs</span><span class="op">$</span><span class="va">byFeature</span>, <span class="fu">rowData</span><span class="op">(</span><span class="va">leduc_minimal</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    by <span class="op">=</span> <span class="st">"feature"</span>, by2 <span class="op">=</span> <span class="st">"Sequence"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- Plot results ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot result in cell-space, ie each dot is a cell</span></span></span>
<span class="r-in"><span><span class="fu">scpComponentPlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">bySamplePCs</span>, </span></span>
<span class="r-in"><span>    pointParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="co">## ggplot arguments</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">SampleType</span>, shape <span class="op">=</span> <span class="va">lcbatch</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        alpha <span class="op">=</span> <span class="fl">0.6</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ScpModel-ComponentAnalysis-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot result in peptide-space, ie each dot is a peptide</span></span></span>
<span class="r-in"><span><span class="fu">scpComponentPlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">byFeaturePCs</span>, </span></span>
<span class="r-in"><span>    pointParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"dodgerblue"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ScpModel-ComponentAnalysis-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot both</span></span></span>
<span class="r-in"><span><span class="fu">scpComponentBiplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">bySamplePCs</span>, <span class="va">byFeaturePCs</span>, </span></span>
<span class="r-in"><span>    pointParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">SampleType</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    labelParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max.overlaps <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    textBy <span class="op">=</span> <span class="st">"gene"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ScpModel-ComponentAnalysis-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####---- Aggregate results ----####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Aggregate to protein-level results</span></span></span>
<span class="r-in"><span><span class="va">byProteinPCs</span> <span class="op">&lt;-</span> <span class="fu">scpComponentAggregate</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">byFeaturePCs</span>, fcol <span class="op">=</span> <span class="st">"Leading.razor.protein.id"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Components may no longer be orthogonal after aggregation.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot result in protein-space, ie each dot is a protein</span></span></span>
<span class="r-in"><span><span class="fu">scpComponentPlot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">byProteinPCs</span>, </span></span>
<span class="r-in"><span>    pointParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"firebrick"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ScpModel-ComponentAnalysis-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christophe Vanderaa, Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer></div>






  </body></html>

